---
title: "Visuals"
---

<figure style="text-align: center;">
  <img src="pic6.png" width="75%">
  <figcaption>
    Illustration by Michelle Pereira, The Guardian‚Äù 
    <a href="https://www.theguardian.com/australia-news/2023/aug/22/do-australian-catholic-hospitals-perform-abortions-provide-contraception-reproductive-care</a>">TheGuardian.com</a>.
  </figcaption>
</figure>

<div style="text-align: justify;">
This part of my project focuses on examining abortion rates and religiosity levels across the United States. I used several R packages to create static and interactive maps, allowing the data to be explored more clearly and in a user-friendly way. The research provides an insightful look into the relationship between these two variables. While some states enforce strict abortion bans and others do not, the level of religiosity, although important, is not the main factor driving higher or lower abortion rates when comparing states.
</div>

```{r}
#| message: false
#| warning: false
library(tidyverse)
library(maps)
library(sf)
library(leaflet)
library(poliscidata)
library(viridis)
```

```{r}
raw.data <- as_tibble(poliscidata::states)

us_info <- raw.data |>
  transmute(
    state_name = state |>
      as.character() |>
      str_squish() |>
      str_replace_all("([a-z])([A-Z])", "\\1 \\2") |>
      str_to_lower(), ar = abort_rate08, religiosity  = religiosity3) |>
      filter(!state_name %in% c("hawaii","alaska"))

states_polygon <- as_tibble(map_data("state")) |>
  select(lat, region, group,long, order)

static_merge <- states_polygon |>
  inner_join(us_info, by = c("region" = "state_name"))

static_merge$religiosity <- factor(
  static_merge$religiosity,
  levels = c("Low","Mid","High")
)

ggplot(static_merge, aes(long, lat, group = group, fill = ar)) +
  geom_polygon(color = "grey30", linewidth = 0.2) +
  coord_map() +
  theme_void() +
  scale_fill_viridis_c(option = "inferno") +
  labs(
    title = "Abortion Rate in 2008",
    fill = "Abortions per 1,000",
    caption = "Janda, K., Berry, W., & Bingham Powell, G. (2019)."
  )



# The lowest abortion rates appear in North Dakota, Idaho, Mississippi, and Wyoming. All of them have fewer than 10 abortions per 1,000 women. The highest rates are in New York, New Jersey, Florida, and California. These states show more than 40 abortions per 1,000 women. This may suggest that more economically developed states have higher abortion rates, possibly because of greater access to healthcare.

us_full <- read_sf("https://rstudio.github.io/leaflet/json/us-states.geojson")

interactive_merge <- us_full |>
  mutate(
    state_name = name |>
      str_to_lower() |>
      str_replace_all("district of columbia","DC")
  ) |>
  inner_join(us_info, by = "state_name") |>
  filter(!name %in% c("Hawaii","Alaska"))

pal_abort <- colorNumeric(
  palette = "RdYlGn",
  domain = interactive_merge$ar
)

leaflet(interactive_merge) |>
  addTiles() |>
  setView(-96, 37.8, zoom = 4) |>
  addPolygons(
    fillColor = ~pal_abort(ar),
    color = "white",
    weight = 1,
    fillOpacity = 0.8,
    highlightOptions = highlightOptions(
      weight = 2, color = "#666",
      fillOpacity = 0.9, bringToFront = TRUE
    ),
    label = ~paste0(name, ": ", ar, " per 1,000 women")
  ) |>
  addLegend(
    pal = pal_abort,
    values = ~ar,
    title = "Abortion Rate",
    position = "bottomright"
  )

ggplot(static_merge, aes(long, lat, group = group, fill = religiosity)) +
  geom_polygon(color = "grey30", linewidth = 0.2) +
  coord_map() +
  theme_void() +
  scale_fill_brewer(palette = "Dark2") +
  labs(
    title = "Religiosity Level by State",
    fill = "Religiosity",
    caption = "Janda, K., Berry, W., & Bingham Powell, G. (2019)."
  )


pal_relig <- colorFactor(
  palette = "Set2",
  levels = c("Low","Mid","High"), 
  domain = interactive_merge$religiosity
)

leaflet(interactive_merge) |>
  addTiles() |>
  setView(-96, 37.8, zoom = 4) |>
  addPolygons(
    fillColor = ~pal_relig(religiosity),
    color = "white",
    weight = 1,
    fillOpacity = 0.8,
    highlightOptions = highlightOptions(
      weight = 2, color = "#666",
      fillOpacity = 0.9, bringToFront = TRUE
    ),
    label = ~paste0(name, ": ", religiosity)
  ) |>
  addLegend(
    pal = pal_relig,
    values = ~religiosity,
    title = "Religiosity Level",
    position = "bottomright"
  )

```
<div style="text-align: justify;">
In conclusion, using the socio-data set from Janda, Berry, and Bingham Powell (2019) shows that the relationship between abortion rates and state-level religiosity can be a useful starting point for identifying broad patterns. However, because abortion policies, religious composition, and cultural norms vary significantly across states, a more focused, state-by-state analysis is necessary for deeper insight. Relying on visualizations alone cannot fully capture the complexity of this topic. To reach stronger, more reliable conclusions, future research should narrow the scope, select specific states or regions, and conduct more detailed statistical and contextual analysis.
</div>

